<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Mystery in Three Acts</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=UnifrakturMaguntia&family=Josefin+Sans:wght@100;200;300&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #080808;
            --border: #2a2010;
            --gold: #c9a84c;
            --gold-dim: #7a5e25;
            --red: #8b1a1a;
            --text: #d4c9b0;
            --text-dim: #7a7060;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
            background: var(--bg);
            color: var(--text);
            font-family: 'Cormorant Garamond', serif;
            overflow-x: hidden;
        }

        /* Grain overlay */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 9999;
            opacity: 0.5;
        }

        /* Vignette */
        body::after {
            content: '';
            position: fixed;
            inset: 0;
            background: radial-gradient(ellipse at center, transparent 40%, rgba(0, 0, 0, 0.85) 100%);
            pointer-events: none;
            z-index: 9998;
        }

        /* â”€â”€ PAGE SYSTEM â”€â”€ */
        .page {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.2s ease;
            overflow-y: auto;
            z-index: 10;
        }

        .page.active {
            opacity: 1;
            pointer-events: all;
        }

        /* Particle canvas */
        #particle-canvas {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 2;
            transition: opacity 2.5s ease;
        }

        #particle-canvas.dimmed {
            opacity: 0;
        }

        /* â”€â”€ HOME PAGE â”€â”€ */
        .home-eyebrow {
            font-family: 'Cormorant Garamond', serif;
            font-size: 0.75rem;
            letter-spacing: 0.4em;
            color: var(--gold-dim);
            text-transform: uppercase;
            margin-bottom: 1.5rem;
            animation: fadeUp 2s ease forwards;
        }

        .home-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: clamp(3rem, 8vw, 7rem);
            color: var(--gold);
            text-align: center;
            line-height: 1;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 60px rgba(201, 168, 76, 0.3), 0 0 120px rgba(201, 168, 76, 0.1);
            animation: fadeUp 2s ease 0.3s forwards;
            opacity: 0;
        }

        .home-subtitle {
            font-style: italic;
            font-size: 1rem;
            color: var(--text-dim);
            letter-spacing: 0.2em;
            margin-bottom: 4rem;
            animation: fadeUp 2s ease 0.6s forwards;
            opacity: 0;
        }

        .act-buttons {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            animation: fadeUp 2s ease 0.9s forwards;
            opacity: 0;
            flex-wrap: wrap;
            justify-content: center;
        }

        .act-btn {
            position: relative;
            background: transparent;
            border: 1px solid var(--gold-dim);
            color: var(--gold);
            font-family: 'Josefin Sans', sans-serif;
            font-size: 0.75rem;
            letter-spacing: 0.2em;
            padding: 1.1rem 2rem;
            cursor: pointer;
            transition: all 0.5s ease;
            overflow: hidden;
            white-space: nowrap;
        }

        .act-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--gold);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.4s ease;
            z-index: -1;
        }

        .act-btn:hover {
            color: var(--bg);
            border-color: var(--gold);
            box-shadow: 0 0 40px rgba(201, 168, 76, 0.2);
        }

        .act-btn:hover::before {
            transform: scaleX(1);
        }

        .divider {
            width: 1px;
            height: 50px;
            background: linear-gradient(to bottom, transparent, var(--gold-dim), transparent);
            flex-shrink: 0;
        }

        /* â”€â”€ SECTION LABEL + TITLE (modern / Josefin Sans) â”€â”€ */
        .section-label {
            font-family: 'Josefin Sans', sans-serif;
            font-size: 0.62rem;
            font-weight: 100;
            letter-spacing: 0.55em;
            color: var(--gold-dim);
            text-transform: uppercase;
            margin-bottom: 0.6rem;
        }

        .section-title {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 100;
            font-size: clamp(1.5rem, 3.5vw, 2.8rem);
            letter-spacing: 0.2em;
            color: var(--gold);
            text-align: center;
            text-transform: uppercase;
            text-shadow: 0 0 40px rgba(201, 168, 76, 0.2);
            margin-bottom: 2.5rem;
        }

        /* â”€â”€ BACK BUTTON â”€â”€ */
        .back-btn {
            position: fixed;
            top: 1.5rem;
            left: 1.5rem;
            background: transparent;
            border: 1px solid var(--gold-dim);
            color: var(--gold-dim);
            font-family: 'Josefin Sans', sans-serif;
            font-weight: 200;
            font-size: 0.65rem;
            letter-spacing: 0.3em;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 200;
            display: none;
            text-transform: uppercase;
        }

        .back-btn:hover {
            color: var(--gold);
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(201, 168, 76, 0.15);
        }

        .back-btn.visible {
            display: block;
        }

        /* â”€â”€ FORM CONTAINERS â”€â”€ */
        .password-wrap,
        .act2-wrap {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
            max-width: 460px;
            width: 100%;
        }

        .mystery-text {
            font-style: italic;
            color: var(--text-dim);
            text-align: center;
            font-size: 1.05rem;
            line-height: 1.9;
        }

        .question-text {
            text-align: center;
            font-size: 1.2rem;
            font-style: italic;
            color: var(--text);
            line-height: 1.7;
        }

        /* â”€â”€ INPUTS â”€â”€ */
        .pw-input,
        .answer-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--gold-dim);
            color: var(--gold);
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.2rem;
            letter-spacing: 0.25em;
            padding: 0.8rem 1.2rem;
            text-align: center;
            outline: none;
            transition: all 0.3s ease;
        }

        .pw-input:focus,
        .answer-input:focus {
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(201, 168, 76, 0.1);
        }

        .pw-input::placeholder,
        .answer-input::placeholder {
            color: var(--text-dim);
            font-style: italic;
            letter-spacing: 0.15em;
        }

        .pw-error {
            color: var(--red);
            font-style: italic;
            font-size: 0.9rem;
            letter-spacing: 0.08em;
            opacity: 0;
            transition: opacity 0.3s;
            text-align: center;
        }

        .pw-error.show {
            opacity: 1;
        }

        /* â”€â”€ SUBMIT BUTTON â”€â”€ */
        .submit-btn {
            background: transparent;
            border: 1px solid var(--gold-dim);
            color: var(--gold);
            font-family: 'Josefin Sans', sans-serif;
            font-weight: 200;
            font-size: 0.62rem;
            letter-spacing: 0.38em;
            text-transform: uppercase;
            padding: 0.8rem 2.2rem;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--gold);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.35s ease;
            z-index: -1;
        }

        .submit-btn:hover {
            color: var(--bg);
            border-color: var(--gold);
        }

        .submit-btn:hover::before {
            transform: scaleX(1);
        }

        /* â”€â”€ VIDEO PAGES â”€â”€ */
        .video-wrap {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 820px;
        }

        .video-container {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            border: 1px solid var(--border);
        }

        .video-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Transcript */
        .transcript-wrap {
            width: 100%;
        }

        .transcript-header {
            border: 1px solid var(--border);
            border-top: none;
            padding: 0.7rem 1.2rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: border-color 0.3s;
            background: rgba(255, 255, 255, 0.02);
        }

        .transcript-header:hover {
            border-color: var(--gold-dim);
        }

        .transcript-header span:first-child {
            font-family: 'Josefin Sans', sans-serif;
            font-weight: 100;
            font-size: 0.6rem;
            letter-spacing: 0.42em;
            color: var(--gold-dim);
            text-transform: uppercase;
        }

        .transcript-toggle {
            color: var(--gold-dim);
            font-size: 1rem;
        }

        .transcript-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.6s ease;
            border: 1px solid var(--border);
            border-top: none;
            background: rgba(255, 255, 255, 0.01);
        }

        .transcript-body.open {
            max-height: 420px;
        }

        .transcript-inner {
            padding: 1.2rem;
        }

        .transcript-lang-tabs {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .lang-tab {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
            font-family: 'Josefin Sans', sans-serif;
            font-weight: 200;
            font-size: 0.62rem;
            letter-spacing: 0.25em;
            text-transform: uppercase;
            padding: 0.3rem 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .lang-tab.active {
            border-color: var(--gold-dim);
            color: var(--gold);
        }

        .transcript-text {
            font-style: italic;
            line-height: 1.9;
            color: var(--text-dim);
            font-size: 0.95rem;
            display: none;
            overflow-y: auto;
            max-height: 280px;
        }

        .transcript-text.active {
            display: block;
        }

        /* â”€â”€ PROGRESS DOTS â”€â”€ */
        .progress-dots {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--border);
            transition: background 0.4s;
        }

        .dot.done {
            background: var(--gold-dim);
        }

        .dot.current {
            background: var(--gold);
        }

        /* â”€â”€ BUDGET FORM â”€â”€ */
        .budget-form {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .budget-row {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .budget-label {
            flex: 1;
            font-family: 'Josefin Sans', sans-serif;
            font-weight: 100;
            font-size: 0.62rem;
            letter-spacing: 0.3em;
            color: var(--text-dim);
            text-transform: uppercase;
        }

        .budget-input {
            width: 80px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--gold-dim);
            color: var(--gold);
            font-family: 'Cormorant Garamond', serif;
            font-size: 1rem;
            padding: 0.5rem 0.6rem;
            outline: none;
            text-align: center;
            transition: border-color 0.3s;
        }

        .budget-input:focus {
            border-color: var(--gold);
        }

        .budget-pct {
            color: var(--gold-dim);
            font-size: 0.9rem;
        }

        .budget-total {
            text-align: right;
            font-size: 0.85rem;
            color: var(--text-dim);
            font-style: italic;
        }

        .budget-total.valid {
            color: var(--gold-dim);
        }

        .budget-total.invalid {
            color: var(--red);
        }

        .budget-total.leisure-warning {
            color: #a07830;
            font-style: italic;
        }

        /* â”€â”€ ACT III FINALE â”€â”€ */
        .finale-wrap {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            max-width: 520px;
            text-align: center;
        }

        .finale-door {
            font-size: clamp(4rem, 12vw, 8rem);
            line-height: 1;
            animation: pulseGlow 3s ease-in-out infinite;
        }

        @keyframes pulseGlow {

            0%,
            100% {
                filter: drop-shadow(0 0 20px rgba(201, 168, 76, 0.2));
            }

            50% {
                filter: drop-shadow(0 0 60px rgba(201, 168, 76, 0.7));
            }
        }

        .finale-message {
            font-size: 1.25rem;
            font-style: italic;
            color: var(--text);
            line-height: 1.9;
        }

        .finale-sub {
            font-family: 'Josefin Sans', sans-serif;
            font-weight: 100;
            font-size: 0.62rem;
            letter-spacing: 0.5em;
            color: var(--gold-dim);
            text-transform: uppercase;
        }

        /* â”€â”€ ORNAMENT LINE â”€â”€ */
        .ornament {
            display: flex;
            align-items: center;
            gap: 1rem;
            width: 100%;
            max-width: 360px;
            color: var(--gold-dim);
            font-size: 0.6rem;
        }

        .ornament::before,
        .ornament::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border);
        }

        /* â”€â”€ ANIMATIONS â”€â”€ */
        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(18px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        ::-webkit-scrollbar {
            width: 3px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gold-dim);
        }
    </style>
</head>

<body>

    <canvas id="particle-canvas"></canvas>
    <button class="back-btn" id="backBtn" onclick="goHome()">â† Return</button>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HOME
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page active" id="page-home">
        <div class="home-eyebrow">A Mystery in Three Acts</div>
        <h1 class="home-title">Before I Choose You</h1>
        <p class="home-subtitle">Seek the truth between the walls</p>
        <div class="act-buttons">
            <button class="act-btn" onclick="navigate('page-act1-password')">Act I</button>
            <div class="divider"></div>
            <button class="act-btn" onclick="navigate('page-act2-q1')">Act II</button>
            <div class="divider"></div>
            <button class="act-btn" onclick="navigate('page-act3-q1')">Act III</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT I â€” PASSWORD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act1-password">
        <div class="section-label">Act I</div>
        <h2 class="section-title">Identify the Suspect</h2>
        <div class="password-wrap">
            <p class="mystery-text">
                A photograph lies before you â€” incomplete.<br>
                Somewhere in its fragments hides the suspect.<br><br>
                To reveal them, speak the name of the place<br>where it all began.
            </p>
            <div class="ornament">âœ¦</div>
            <input class="pw-input" id="pw-input" placeholder="Where was the photo taken..."
                onkeydown="if(event.key==='Enter')checkPassword()">
            <p class="pw-error" id="pw-error">Hint: Where was the photo taken? It has a boardwalk...</p>
            <button class="submit-btn" onclick="checkPassword()">Unlock</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT I â€” VIDEO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act1-video">
        <div class="section-label">Act I</div>
        <h2 class="section-title">Against All Odds</h2>
        <div class="video-wrap">
            <div class="video-container">
                <iframe id="act1-iframe" src="" allowfullscreen></iframe>
            </div>
            <div class="transcript-wrap">
                <div class="transcript-header" onclick="toggleTranscript('t1')">
                    <span>View Transcript</span>
                    <span class="transcript-toggle" id="t1-icon">â–¾</span>
                </div>
                <div class="transcript-body" id="t1-body">
                    <div class="transcript-inner">
                        <div class="transcript-lang-tabs">
                            <button class="lang-tab active" onclick="setLang('t1','en',this)">English</button>
                            <button class="lang-tab" onclick="setLang('t1','zh',this)">ä¸­æ–‡</button>
                        </div>
                        <div class="transcript-text active" id="t1-en">
                            Dear Koko,<br>
                            <br>
                            Against all odds, weâ€™re still together. Improbable, isnâ€™t it?<br>
                            <br>
                            How improbable was it that Iâ€”a Chinese-American boy, lost and confused after a recent
                            breakupâ€”would turn to badminton,
                            of all things, as a place to rebuild a sense of self and belonging?<br>
                            <br>
                            How improbable was it that youâ€”a girl with a stable, settled life in Mainland Chinaâ€”would
                            feel the urge to leave your
                            friends and family behind to start over in the Bay Area?<br>
                            <br>
                            How improbable was it that Kevin happened to be at the gym without a partner, had the
                            courage to reach out, and started
                            a badminton social group with me?<br>
                            <br>
                            And that Kiko would run into you and Pia in the hallway of your enormous apartment complex,
                            only to invite you to return
                            to your childhood sportâ€”with us?<br>
                            <br>
                            We spoke different languages.<br>
                            We grew up in different cultures.<br>
                            We were at different stages in life.<br>
                            <br>
                            And yetâ€”here we are, three years later.<br>
                            <br>
                            While other friends have come and gone, weâ€™ve stayed.<br>
                            Not by accident, but by choice.<br>
                            And weâ€™re stronger than ever.<br>
                            <br>
                            Improbable, isnâ€™t it?<br>
                            Maybe not.<br>
                            <br>
                            From our very first meeting, we worked to embrace what we shared.<br>
                            <br>
                            We bonded over gamesâ€”card games, word games, logic puzzles, and very questionable Chinese
                            puns.<br>
                            We explored new interests together: roller skating, tennis, fishing, uni foraging, karaoke,
                            and of course, the
                            arcade.<br>
                            We traveled across the world, from the US Pacific Northwest all the way to the Florida
                            Everglades, and all the way to
                            China and back.<br>
                            <br>
                            So maybe meeting you felt improbable.<br>
                            <br>
                            But staying together hasnâ€™t been about luck.<br>
                            Itâ€™s been about fitâ€”and effort.<br>
                            <br>
                            â€”<br>
                            <br>
                            When youâ€™re ready, grab the latex gloves hidden inside the stove, and proceed into the
                            master bedroom.<br>
                            Itâ€™s time to see who the real victims are.<br>
                            <br>
                            The truth wonâ€™t be about who died,<br>
                            but about what survived.<br>
                        </div>
                        <div class="transcript-text" id="t1-zh">
                            äº²çˆ±çš„ Kokoï¼Œ<br>
                            <br>
                            åœ¨ç§ç§å‡ ä¹ä¸å¯èƒ½çš„æ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬ç«Ÿç„¶è¿˜åœ¨ä¸€èµ·ã€‚å¬èµ·æ¥å¾ˆä¸å¯æ€è®®ï¼Œå¯¹å—ï¼Ÿ<br>
                            <br>
                            ä¸€ä¸ªåˆšç»å†åˆ†æ‰‹ã€è¿·èŒ«å¤±æªçš„åè£”ç¾å›½ç”·å­©ï¼Œç«Ÿç„¶ä¼šæŠŠç¾½æ¯›çƒâ€”â€”ååæ˜¯ç¾½æ¯›çƒâ€”â€”å½“ä½œé‡å»ºè‡ªæˆ‘ä¸å½’å±æ„Ÿçš„èµ·ç‚¹ï¼Œè¿™æœ¬èº«æœ‰å¤šä¹ˆä¸å¯æ€è®®ï¼Ÿ<br>
                            <br>
                            è€Œä½ â€”â€”ä¸€ä¸ªåœ¨ä¸­å›½å¤§é™†æ‹¥æœ‰å®‰ç¨³ç”Ÿæ´»çš„å¥³å­©â€”â€”ç«Ÿç„¶ä¼šèŒç”Ÿç¦»å¼€äº²æœ‹å¥½å‹ï¼Œè¿œèµ´æ¹¾åŒºé‡æ–°å¼€å§‹çš„å¿µå¤´ï¼Œè¿™åˆæ˜¯æ€æ ·çš„å°æ¦‚ç‡äº‹ä»¶ï¼Ÿ<br>
                            <br>
                            è¿˜æœ‰ Kevinã€‚é‚£å¤©ä»–æ°å¥½åœ¨çƒé¦†æ²¡æœ‰æ­æ¡£ï¼Œæ°å¥½é¼“èµ·å‹‡æ°”ä¸»åŠ¨æ­è¯ï¼Œæ°å¥½å’Œæˆ‘ä¸€èµ·åˆ›ç«‹äº†ç¾½æ¯›çƒç¤¾äº¤å°ç»„â€”â€”è¿™æ ·çš„å·§åˆï¼Œæ¦‚ç‡åˆæœ‰å¤šä½ï¼Ÿ<br>
                            <br>
                            å†åæ¥ï¼ŒKiko åœ¨ä½ é‚£æ ‹å·¨å¤§çš„å…¬å¯“æ¥¼èµ°å»Šé‡Œï¼Œååé‡è§äº†ä½ å’Œ Piaï¼Œåˆååé‚€è¯·ä½ é‡æ‹¾å„¿æ—¶çš„è¿åŠ¨â€”â€”è€Œä¸”ï¼Œæ˜¯å’Œæˆ‘ä»¬ä¸€èµ·ã€‚è¿™éš¾é“ä¸æ˜¯å‘½è¿æœ€ç²¾å¦™çš„å®‰æ’å—ï¼Ÿ<br>
                            <br>
                            æˆ‘ä»¬è¯´ç€ä¸åŒçš„è¯­è¨€ã€‚<br>
                            æˆ‘ä»¬æˆé•¿äºä¸åŒçš„æ–‡åŒ–ã€‚<br>
                            æˆ‘ä»¬èº«å¤„äººç”Ÿçš„ä¸åŒé˜¶æ®µã€‚<br>
                            <br>
                            ç„¶è€Œâ€”â€”ä¸‰å¹´è¿‡å»äº†ï¼Œæˆ‘ä»¬ä¾ç„¶åœ¨ä¸€èµ·ã€‚<br>
                            <br>
                            æœ‹å‹æ¥æ¥å¾€å¾€ï¼Œæœ‰äººå‡ºç°ï¼Œä¹Ÿæœ‰äººç¦»å¼€ã€‚<br>
                            ä½†æˆ‘ä»¬ç•™ä¸‹æ¥äº†ã€‚<br>
                            ä¸æ˜¯å› ä¸ºå¶ç„¶ï¼Œè€Œæ˜¯å› ä¸ºé€‰æ‹©ã€‚<br>
                            è€Œä¸”ï¼Œæ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´åŠ åšå®šã€‚<br>
                            <br>
                            ä¸å¯æ€è®®ï¼Œå¯¹å—ï¼Ÿ<br>
                            ä¹Ÿè®¸ï¼Œå¹¶ä¸å®Œå…¨æ˜¯ã€‚<br>
                            <br>
                            ä»ç¬¬ä¸€æ¬¡è§é¢èµ·ï¼Œæˆ‘ä»¬å°±åŠªåŠ›å»æ‹¥æŠ±å½¼æ­¤çš„ç›¸ä¼¼ä¹‹å¤„ã€‚<br>
                            <br>
                            æˆ‘ä»¬å› æ¸¸æˆè€Œäº²è¿‘â€”â€”çº¸ç‰Œã€æ–‡å­—ã€é€»è¾‘è°œé¢˜ï¼Œè¿˜æœ‰é‚£äº›â€œè´¨é‡å ªå¿§â€çš„ä¸­æ–‡åŒå…³è¯­ã€‚<br>
                            æˆ‘ä»¬ä¸€èµ·æ¢ç´¢æ–°çš„å…´è¶£ï¼šè½®æ»‘ã€ç½‘çƒã€é’“é±¼ã€èµ¶æµ·é‡‡æµ·èƒ†ã€å¡æ‹‰ OKï¼Œå½“ç„¶è¿˜æœ‰è¡—æœºã€‚<br>
                            æˆ‘ä»¬ä¸€èµ·æ—…è¡Œï¼Œä»ç¾å›½å¤ªå¹³æ´‹è¥¿åŒ—ä¸€è·¯åˆ°ä½›ç½—é‡Œè¾¾å¤§æ²¼æ³½åœ°ï¼Œå†è·¨è¶Šå¤ªå¹³æ´‹åˆ°ä¸­å›½ï¼Œåˆä¸€èµ·å›åˆ°ç¾å›½ã€‚<br>
                            <br>
                            æ‰€ä»¥ï¼Œé‡è§ä½ æˆ–è®¸æ˜¯æ¦‚ç‡æä½çš„å¥‡è¿¹ã€‚<br>
                            <br>
                            ä½†èƒ½èµ°åˆ°ä»Šå¤©ï¼Œä»æ¥ä¸æ˜¯è¿æ°”ã€‚<br>
                            è€Œæ˜¯å¥‘åˆã€‚<br>
                            ä¹Ÿæ˜¯æˆ‘ä»¬ä¸€æ¬¡æ¬¡ä¸»åŠ¨çš„é€‰æ‹©ä¸ä»˜å‡ºã€‚<br>
                            <br>
                            â€”â€”<br>
                            <br>
                            å½“ä½ å‡†å¤‡å¥½äº†ï¼Œæˆ´ä¸Šè—åœ¨ç‚‰å­é‡Œçš„ä¹³èƒ¶æ‰‹å¥—ï¼Œèµ°è¿›ä¸»å§ã€‚<br>
                            <br>
                            æ˜¯æ—¶å€™æ­æ™“ï¼Œè°æ‰æ˜¯çœŸæ­£çš„â€œå—å®³è€…â€äº†ã€‚<br>
                            <br>
                            çœŸç›¸ï¼Œä»æ¥ä¸åœ¨äºè°æ­»å»ã€‚<br>
                            è€Œåœ¨äºï¼Œä»€ä¹ˆå¾—ä»¥å¹¸å­˜ã€‚<br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT II â€” Q1: Cubes
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act2-q1">
        <div class="section-label">Act II Â· Save the Victims</div>
        <h2 class="section-title">Question I</h2>
        <div class="progress-dots">
            <div class="dot current"></div>
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>
        <div class="act2-wrap">
            <p class="question-text">How many cubes were there in the Big Brain Academy game?</p>
            <div class="ornament">âœ¦</div>
            <input class="answer-input" id="q1-input" type="number" placeholder="Enter a number..."
                onkeydown="if(event.key==='Enter')checkQ1()">
            <p class="pw-error" id="q1-error">Hint: It's 20...minus 1...</p>
            <button class="submit-btn" onclick="checkQ1()">Confirm</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT II â€” Q2: Budget
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act2-q2">
        <div class="section-label">Act II Â· Save the Victims</div>
        <h2 class="section-title">Question II</h2>
        <div class="progress-dots">
            <div class="dot done"></div>
            <div class="dot current"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>
        <div class="act2-wrap">
            <p class="question-text">What is your spending budget allocation?<br><em
                    style="font-size:0.85rem;color:var(--text-dim)">The three dimensions must sum to 100%</em></p>
            <div class="ornament">âœ¦</div>
            <div class="budget-form">
                <div class="budget-row">
                    <span class="budget-label">Fixed Costs</span>
                    <input class="budget-input" id="b-fixed" type="number" min="0" max="100" value="0"
                        oninput="updateBudgetTotal()">
                    <span class="budget-pct">%</span>
                </div>
                <div class="budget-row">
                    <span class="budget-label">Savings</span>
                    <input class="budget-input" id="b-savings" type="number" min="0" max="100" value="0"
                        oninput="updateBudgetTotal()">
                    <span class="budget-pct">%</span>
                </div>
                <div class="budget-row">
                    <span class="budget-label">Leisure</span>
                    <input class="budget-input" id="b-leisure" type="number" min="0" max="100" value="0"
                        oninput="updateBudgetTotal()">
                    <span class="budget-pct">%</span>
                </div>
                <div class="budget-total valid" id="budget-total">Total: 100% âœ“</div>
            </div>
            <p class="pw-error" id="q2-error">The allocation must total 100â€¦</p>
            <button class="submit-btn" onclick="checkQ2()">Confirm</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT II â€” Q3: Health
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act2-q3">
        <div class="section-label">Act II Â· Save the Victims</div>
        <h2 class="section-title">Question III</h2>
        <div class="progress-dots">
            <div class="dot done"></div>
            <div class="dot done"></div>
            <div class="dot current"></div>
            <div class="dot"></div>
        </div>
        <div class="act2-wrap">
            <p class="question-text">What should we eat to cure health problems?</p>
            <div class="ornament">âœ¦</div>
            <input class="answer-input" id="q3-input" type="text" placeholder="Enter the foodâ€¦"
                onkeydown="if(event.key==='Enter')checkQ3()">
            <p class="pw-error" id="q3-error">Think "healthy"...</p>
            <button class="submit-btn" onclick="checkQ3()">Confirm</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT II â€” Q4: Doubts
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act2-q4">
        <div class="section-label">Act II Â· Save the Victims</div>
        <h2 class="section-title">Question IV</h2>
        <div class="progress-dots">
            <div class="dot done"></div>
            <div class="dot done"></div>
            <div class="dot done"></div>
            <div class="dot current"></div>
        </div>
        <div class="act2-wrap">
            <p class="question-text">What is the cure for doubts and insecurities?</p>
            <div class="ornament">âœ¦</div>
            <input class="answer-input" id="q4-input" type="text" placeholder="your answerâ€¦"
                onkeydown="if(event.key==='Enter')checkQ4()">
            <p class="pw-error" id="q4-error">Look for the needle in the plushie haystackâ€¦</p>
            <button class="submit-btn" onclick="checkQ4()">Confirm</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT II â€” VIDEO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act2-video">
        <div class="section-label">Act II</div>
        <h2 class="section-title">Through Every Storm</h2>
        <div class="video-wrap">
            <div class="video-container">
                <iframe id="act2-iframe" src="" allowfullscreen></iframe>
            </div>
            <div class="transcript-wrap">
                <div class="transcript-header" onclick="toggleTranscript('t2')">
                    <span>View Transcript</span>
                    <span class="transcript-toggle" id="t2-icon">â–¾</span>
                </div>
                <div class="transcript-body" id="t2-body">
                    <div class="transcript-inner">
                        <div class="transcript-lang-tabs">
                            <button class="lang-tab active" onclick="setLang('t2','en',this)">English</button>
                            <button class="lang-tab" onclick="setLang('t2','zh',this)">ä¸­æ–‡</button>
                        </div>
                        <div class="transcript-text active" id="t2-en">
                            Thank you for choosing meâ€”and for continuing to choose meâ€”over these past three years.<br>
                            <br>
                            When we first met, I was uncertain whether I was truly ready for another relationship.<br>
                            That uncertainty made me hesitant, and at times, I did not treat you with the steadiness you
                            deserved.<br>
                            Yet you met my inconsistency with patience.<br>
                            You gave me space when I needed time to rediscover myself, and when I was finally ready to
                            commit, you welcomed me
                            without resentmentâ€”only warmth.<br>
                            <br>
                            Over the years, my body has had its own challenges: sprained ankles, blood pressure
                            anxieties, seasonal flus that
                            overstayed their welcome.<br>
                            And each time, without hesitation, you stood beside me.<br>
                            You accompanied me to appointments, reassured me when my thoughts spiraled, and once even
                            pushed me through China in a
                            wheelchairâ€”never once complaining.<br>
                            Your care has never been loud, but it has always been unwavering.<br>
                            <br>
                            The biggest challenge for both of us continues to be work life balance.<br>
                            Despite our demanding jobs, we have learned to reclaim a small amount of structure for
                            ourselvesâ€”decompressing at the
                            arcade and playing games, tending to the cats, or simply walking side by side in downtown
                            Sunnyvale.<br>
                            In those quiet rituals, we find our way back to each other.<br>
                            <br>
                            Koko, you are remarkably strong.<br>
                            Through my waveringâ€”my doubts, my stress, my anxietiesâ€”you have been the constant.<br>
                            Steady.<br>
                            Grounded.<br>
                            Resolute.<br>
                            You have not merely endured the turbulence; you have helped steer us through it.<br>
                            <br>
                            Being part of your life has been one of the great privileges of mine.<br>
                            And I hope that I may remain by your side for many years to come.<br>
                            <br>
                            The only question that remains is this:<br>
                            <br>
                            Do you want the same?<br>
                            <br>
                            Because if you do, then it is time.<br>
                            <br>
                            Youâ€™ve confronted the doubts and silenced the insecurities.<br>
                            <br>
                            So now, there is only one thing left to do.<br>
                            Itâ€™s time to identify the one responsible for tonightâ€™s crimes.<br>
                        </div>
                        <div class="transcript-text" id="t2-zh">
                            æ„Ÿè°¢ä½ é€‰æ‹©æˆ‘ï¼Œä¹Ÿæ„Ÿè°¢ä½ åœ¨è¿‡å»ä¸‰å¹´é‡Œï¼Œä¸€æ¬¡åˆä¸€æ¬¡åœ°ç»§ç»­é€‰æ‹©æˆ‘ã€‚<br>
                            <br>
                            æˆ‘ä»¬åˆæ¬¡ç›¸é‡æ—¶ï¼Œæˆ‘å¹¶ä¸ç¡®å®šè‡ªå·±æ˜¯å¦çœŸçš„å‡†å¤‡å¥½å¼€å§‹å¦ä¸€æ®µæ„Ÿæƒ…ã€‚<br>
                            è¿™ä»½çŠ¹ç–‘è®©æˆ‘è¸Œèº‡ä¸å‰ï¼Œä¹Ÿè®©ä½ æ‰¿å—äº†æœ¬ä¸è¯¥ç”±ä½ æ‰¿æ‹…çš„åŠ¨æ‘‡ä¸ä¸å®‰ã€‚<br>
                            å¯ä½ å´ç”¨è€å¿ƒå›åº”æˆ‘çš„åå¤ã€‚<br>
                            å½“æˆ‘éœ€è¦æ—¶é—´é‡æ–°æ‰¾å›è‡ªå·±æ—¶ï¼Œä½ ç»™äº†æˆ‘ç©ºé—´ï¼›è€Œå½“æˆ‘ç»ˆäºå‡†å¤‡å¥½åšå®šåœ°æŠ•å…¥æ—¶ï¼Œä½ æ²¡æœ‰æ€¨æ€¼ï¼Œåªæœ‰æ¸©æŸ”åœ°æ¥çº³ã€‚<br>
                            <br>
                            è¿™äº›å¹´é‡Œï¼Œæˆ‘çš„èº«ä½“ä¹Ÿç»™æˆ‘ä»¬æ·»è¿‡ä¸å°‘éº»çƒ¦ï¼šæ‰­ä¼¤çš„è„šè¸ã€è¡€å‹å¸¦æ¥çš„ç„¦è™‘ã€è¿Ÿè¿Ÿä¸é€€çš„å­£èŠ‚æ€§æµæ„Ÿã€‚<br>
                            æ¯ä¸€æ¬¡ï¼Œä½ éƒ½æ¯«ä¸çŠ¹è±«åœ°ç«™åœ¨æˆ‘èº«æ—ã€‚<br>
                            ä½ é™ªæˆ‘çœ‹è¯Šï¼Œåœ¨æˆ‘èƒ¡æ€ä¹±æƒ³æ—¶å®‰æŠšæˆ‘ï¼Œç”šè‡³æœ‰ä¸€æ¬¡åœ¨ä¸­å›½æ¨ç€è½®æ¤…å¸¦æˆ‘å‡ºè¡Œâ€”â€”ä»æœªæŠ±æ€¨è¿‡ä¸€å¥ã€‚<br>
                            ä½ çš„å…³æ€€ä»ä¸å¼ æ‰¬ï¼Œå´å§‹ç»ˆåšå®šã€‚<br>
                            <br>
                            å¯¹æˆ‘ä»¬è€Œè¨€ï¼Œæœ€å¤§çš„æŒ‘æˆ˜å§‹ç»ˆæ˜¯å·¥ä½œä¸ç”Ÿæ´»çš„å¹³è¡¡ã€‚<br>
                            å°½ç®¡äº‹ä¸šç¹å¿™ï¼Œæˆ‘ä»¬ä¾ç„¶ä¸ºå½¼æ­¤ä¿ç•™äº†ä¸€ç‚¹ç§©åºä¸ç©ºé—´â€”â€”å»æ¸¸æˆå…æ”¾æ¾ï¼Œæ‰“å‡ å±€æ¸¸æˆï¼›ç…§é¡¾çŒ«å’ªï¼›æˆ–æ˜¯åœ¨æ¡‘å°¼ç»´å°”å¸‚ä¸­å¿ƒå¹¶è‚©æ•£æ­¥ã€‚<br>
                            åœ¨é‚£äº›å®‰é™è€Œé‡å¤çš„æ—¥å¸¸é‡Œï¼Œæˆ‘ä»¬ä¸€æ¬¡æ¬¡æ‰¾å›å½¼æ­¤ã€‚<br>
                            <br>
                            å¯å¯ï¼Œä½ çœŸçš„å¾ˆåšå¼ºã€‚<br>
                            åœ¨æˆ‘åŠ¨æ‘‡ã€ç„¦è™‘ã€æ€€ç–‘è‡ªå·±çš„æ—¶å€™ï¼Œä½ å§‹ç»ˆå¦‚ä¸€ã€‚<br>
                            æ²‰ç¨³ã€‚<br>
                            è¸å®ã€‚<br>
                            åšå®šã€‚<br>
                            ä½ ä¸ä»…æ‰¿å—äº†é£æµªï¼Œæ›´é™ªæˆ‘ä¸€èµ·æŒèˆµå‰è¡Œã€‚<br>
                            <br>
                            èƒ½å¤Ÿæˆä¸ºä½ ç”Ÿå‘½çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯æˆ‘æ­¤ç”Ÿæœ€çè´µçš„è£å¹¸ä¹‹ä¸€ã€‚<br>
                            æˆ‘å¸Œæœ›åœ¨æœªæ¥æ¼«é•¿çš„å²æœˆé‡Œï¼Œä¾ç„¶å¯ä»¥ç«™åœ¨ä½ èº«æ—ã€‚<br>
                            <br>
                            å”¯ä¸€å‰©ä¸‹çš„é—®é¢˜æ˜¯â€”â€”<br>
                            <br>
                            ä½ æ˜¯å¦ä¹Ÿæ„¿æ„å¦‚æ­¤ï¼Ÿ<br>
                            <br>
                            å¦‚æœç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œé‚£ä¹ˆï¼Œæ˜¯æ—¶å€™äº†ã€‚<br>
                            <br>
                            ä½ å·²ç»ç›´é¢ç–‘è™‘ï¼Œä¹Ÿæ”¾ä¸‹äº†ä¸å®‰ã€‚<br>
                            <br>
                            é‚£ä¹ˆç°åœ¨ï¼Œåªå‰©ä¸‹ä¸€ä»¶äº‹è¦åšäº†ã€‚<br>
                            æ˜¯æ—¶å€™æ‰¾å‡ºä»Šæ™šâ€œæ¡ˆä»¶â€çš„çœŸæ­£ä¸»è°‹ã€‚<br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT III â€” Q1
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act3-q1">
        <div class="section-label">Act III</div>
        <h2 class="section-title">Find the Suspect</h2>
        <div class="act2-wrap">
            <p class="question-text">
                The evidence has been gathered.<br>
                The witnesses have spoken.<br><br>
                <em>Who is the one who has been with you<br>through everything â€” all along?</em>
            </p>
            <div class="ornament">âœ¦</div>
            <input class="answer-input" id="q5-input" type="text" placeholder="name the suspectâ€¦"
                onkeydown="if(event.key==='Enter')checkQ5()">
            <p class="pw-error" id="q5-error">Look closer. The answer is right before you.</p>
            <button class="submit-btn" onclick="checkQ5()">Reveal</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACT III â€” FINALE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="page" id="page-act3-finale">
        <div class="section-label">Act III Â· Case Closed</div>
        <h2 class="section-title">Find the Suspect</h2>
        <div class="finale-wrap">
            <div class="finale-door">ğŸšª</div>
            <p class="finale-message">
                The mystery has been solved.<br>
                The suspect has been found.<br><br>
                You may now open the final door.
            </p>
            <div class="ornament">âœ¦</div>
            <p class="finale-sub">The truth was always here</p>
        </div>
    </div>

    <script>
        // â”€â”€ CONFIG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const ACT1_VIDEO = 'https://www.youtube.com/embed/dQw4w9WgXcQ'; // Replace
        const ACT2_VIDEO = 'https://www.youtube.com/embed/dQw4w9WgXcQ'; // Replace
        const PASSWORD = 'Santa Cruz';
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

        // â”€â”€ PARTICLE SYSTEM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');

        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        resize();
        window.addEventListener('resize', resize);

        const particles = [];
        const EMBER_COLORS = ['#c9a84c', '#e8c96a', '#a07030', '#f0d080', '#8b5e20'];
        const STEAM_COLORS = ['rgba(180,160,100', 'rgba(120,100,60', 'rgba(200,180,120'];

        function spawnEmber() {
            particles.push({
                type: 'ember',
                x: Math.random() * canvas.width,
                y: canvas.height + 10,
                vx: (Math.random() - 0.5) * 0.6,
                vy: -(0.5 + Math.random() * 1.4),
                size: 1 + Math.random() * 2.5,
                color: EMBER_COLORS[Math.floor(Math.random() * EMBER_COLORS.length)],
                alpha: 0, maxAlpha: 0.5 + Math.random() * 0.5,
                life: 0, maxLife: 200 + Math.random() * 400,
                flicker: Math.random() * Math.PI * 2,
                flickerSpeed: 0.04 + Math.random() * 0.08,
                trail: [], trailLen: Math.floor(8 + Math.random() * 20),
            });
        }

        function spawnSteamPuff() {
            const base = STEAM_COLORS[Math.floor(Math.random() * STEAM_COLORS.length)];
            particles.push({
                type: 'steam',
                x: Math.random() * canvas.width,
                y: canvas.height * (0.5 + Math.random() * 0.5),
                vx: (Math.random() - 0.5) * 0.4,
                vy: -(0.3 + Math.random() * 0.7),
                size: 8 + Math.random() * 18,
                growRate: 0.08 + Math.random() * 0.12,
                color: base,
                alpha: 0, maxAlpha: 0.07 + Math.random() * 0.1,
                life: 0, maxLife: 300 + Math.random() * 500,
            });
        }

        let lastEmberTime = 0, lastSteamTime = 0;
        const EMBER_INTERVAL = 80, STEAM_INTERVAL = 220;
        const MAX_EMBERS = 90, MAX_STEAM = 28;

        function updateParticles(ts) {
            if (ts - lastEmberTime > EMBER_INTERVAL && particles.filter(p => p.type === 'ember').length < MAX_EMBERS) {
                spawnEmber(); lastEmberTime = ts;
            }
            if (ts - lastSteamTime > STEAM_INTERVAL && particles.filter(p => p.type === 'steam').length < MAX_STEAM) {
                spawnSteamPuff(); lastSteamTime = ts;
            }

            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.life++;
                const fadeIn = Math.min(p.life / 40, 1);
                const fadeOut = 1 - Math.max((p.life - p.maxLife * 0.7) / (p.maxLife * 0.3), 0);

                if (p.type === 'ember') {
                    p.flicker += p.flickerSpeed;
                    p.vx += Math.sin(p.flicker) * 0.008;
                    p.x += p.vx; p.y += p.vy;
                    p.alpha = p.maxAlpha * fadeIn * fadeOut * (0.85 + 0.15 * Math.sin(p.flicker * 3));

                    p.trail.push({ x: p.x, y: p.y, alpha: p.alpha });
                    if (p.trail.length > p.trailLen) p.trail.shift();

                    for (let t = 0; t < p.trail.length; t++) {
                        const tp = p.trail[t], tf = t / p.trail.length;
                        const tr = p.size * (0.3 + tf * 0.7) * (1 + tf * 3);
                        const sg = ctx.createRadialGradient(tp.x, tp.y, 0, tp.x, tp.y, tr * 2.5);
                        sg.addColorStop(0, `rgba(160,130,60,${tp.alpha * tf * 0.35})`);
                        sg.addColorStop(0.4, `rgba(100,80,30,${tp.alpha * tf * 0.12})`);
                        sg.addColorStop(1, `rgba(60,40,10,0)`);
                        ctx.beginPath(); ctx.arc(tp.x, tp.y, tr * 2.5, 0, Math.PI * 2);
                        ctx.fillStyle = sg; ctx.fill();
                    }

                    const glow = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.size * 5);
                    glow.addColorStop(0, `rgba(255,220,100,${p.alpha * 0.9})`);
                    glow.addColorStop(0.3, `rgba(200,150,50,${p.alpha * 0.4})`);
                    glow.addColorStop(1, 'rgba(100,60,0,0)');
                    ctx.beginPath(); ctx.arc(p.x, p.y, p.size * 5, 0, Math.PI * 2);
                    ctx.fillStyle = glow; ctx.fill();

                    ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fillStyle = p.color; ctx.globalAlpha = p.alpha;
                    ctx.fill(); ctx.globalAlpha = 1;

                } else if (p.type === 'steam') {
                    p.x += p.vx; p.y += p.vy;
                    p.vx += (Math.random() - 0.5) * 0.02;
                    p.size += p.growRate;
                    p.alpha = p.maxAlpha * fadeIn * fadeOut;

                    for (let layer = 3; layer >= 0; layer--) {
                        const lr = p.size * (0.4 + layer * 0.25);
                        const la = p.alpha * (1 - layer * 0.22);
                        const sg = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, lr);
                        sg.addColorStop(0, `${p.color},${la})`);
                        sg.addColorStop(0.5, `${p.color},${la * 0.5})`);
                        sg.addColorStop(1, `${p.color},0)`);
                        ctx.beginPath(); ctx.arc(p.x, p.y, lr, 0, Math.PI * 2);
                        ctx.fillStyle = sg; ctx.fill();
                    }
                }

                if (p.life >= p.maxLife) particles.splice(i, 1);
            }
        }

        function loop(ts) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            updateParticles(ts);
            requestAnimationFrame(loop);
        }
        requestAnimationFrame(loop);

        // â”€â”€ NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const VIDEO_PAGES = new Set(['page-act1-video', 'page-act2-video']);
        let currentPage = 'page-home';

        function navigate(id, skipHistory = false) {
            document.querySelector(`#${currentPage}`).classList.remove('active');
            document.querySelector(`#${id}`).classList.add('active');
            currentPage = id;
            document.getElementById('backBtn').classList.toggle('visible', id !== 'page-home');

            // Fade particles when watching video
            canvas.classList.toggle('dimmed', VIDEO_PAGES.has(id));

            if (!skipHistory) history.pushState({ page: id }, '', '#' + id);
        }

        window.addEventListener('popstate', e => navigate(e.state?.page || 'page-home', true));

        function goHome() {
            navigate('page-home');
            document.getElementById('act1-iframe').src = '';
            document.getElementById('act2-iframe').src = '';
        }

        // â”€â”€ ACT I â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function checkPassword() {
            const val = document.getElementById('pw-input').value;
            const err = document.getElementById('pw-error');
            if (val.trim().toLowerCase() === PASSWORD.toLowerCase()) {
                err.classList.remove('show');
                document.getElementById('act1-iframe').src = ACT1_VIDEO;
                navigate('page-act1-video');
            } else {
                err.classList.add('show');
                setTimeout(() => err.classList.remove('show'), 2500);
            }
        }

        // â”€â”€ ACT II â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function checkQ1() {
            const val = parseInt(document.getElementById('q1-input').value, 10);
            const err = document.getElementById('q1-error');
            if (val === 19) { err.classList.remove('show'); navigate('page-act2-q2'); }
            else { err.classList.add('show'); setTimeout(() => err.classList.remove('show'), 2500); }
        }

        function updateBudgetTotal() {
            const f = parseFloat(document.getElementById('b-fixed').value) || 0;
            const s = parseFloat(document.getElementById('b-savings').value) || 0;
            const l = parseFloat(document.getElementById('b-leisure').value) || 0;
            const total = f + s + l;
            const el = document.getElementById('budget-total');
            if (Math.round(total) === 100) {
                if (l >= 20) {
                    el.textContent = `Total: ${total}% âœ“  â€”  ${l}% on leisureâ€¦ perhaps that could shrink a little?`;
                    el.className = 'budget-total leisure-warning';
                } else {
                    el.textContent = `Total: ${total}% âœ“`;
                    el.className = 'budget-total valid';
                }
            } else {
                el.textContent = `Total: ${total}%`;
                el.className = 'budget-total invalid';
            }
        }

        function checkQ2() {
            const f = parseFloat(document.getElementById('b-fixed').value) || 0;
            const s = parseFloat(document.getElementById('b-savings').value) || 0;
            const l = parseFloat(document.getElementById('b-leisure').value) || 0;
            const err = document.getElementById('q2-error');
            if (Math.round(f + s + l) === 100) { err.classList.remove('show'); navigate('page-act2-q3'); }
            else { err.classList.add('show'); setTimeout(() => err.classList.remove('show'), 2500); }
        }

        function checkQ3() {
            const val = document.getElementById('q3-input').value.trim().toLowerCase();
            const err = document.getElementById('q3-error');
            if (val === 'vegetables' || val === 'vegetable') { err.classList.remove('show'); navigate('page-act2-q4'); }
            else { err.classList.add('show'); setTimeout(() => err.classList.remove('show'), 2500); }
        }

        function checkQ4() {
            const val = document.getElementById('q4-input').value.trim().toLowerCase();
            const err = document.getElementById('q4-error');
            if (val === 'support') {
                err.classList.remove('show');
                document.getElementById('act2-iframe').src = ACT2_VIDEO;
                navigate('page-act2-video');
            } else { err.classList.add('show'); setTimeout(() => err.classList.remove('show'), 2500); }
        }

        // â”€â”€ ACT III â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function checkQ5() {
            const val = document.getElementById('q5-input').value.trim();
            const err = document.getElementById('q5-error');
            // Accept any non-empty answer â€” the real moment is the recognition
            if (val.length > 0) { err.classList.remove('show'); navigate('page-act3-finale'); }
            else { err.classList.add('show'); setTimeout(() => err.classList.remove('show'), 2500); }
        }

        // â”€â”€ TRANSCRIPTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const transcriptOpen = {};

        function toggleTranscript(id) {
            const body = document.getElementById(`${id}-body`);
            const icon = document.getElementById(`${id}-icon`);
            transcriptOpen[id] = !transcriptOpen[id];
            body.classList.toggle('open', transcriptOpen[id]);
            icon.textContent = transcriptOpen[id] ? 'â–´' : 'â–¾';
        }

        function setLang(transcriptId, lang, btn) {
            const wrap = document.getElementById(`${transcriptId}-body`);
            wrap.querySelectorAll('.transcript-text').forEach(el => el.classList.remove('active'));
            wrap.querySelectorAll('.lang-tab').forEach(el => el.classList.remove('active'));
            document.getElementById(`${transcriptId}-${lang}`).classList.add('active');
            btn.classList.add('active');
        }
    </script>
</body>

</html>